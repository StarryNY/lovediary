
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êàë‰ª¨ÁöÑÊÅãÁà±Êó•ËÆ∞</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f0f2f5;
            color: #1c1e21;
            line-height: 1.5;
        }
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
        }

        .navbar-brand {
            font-size: 24px;
            font-weight: bold;
            color: #ff4b6e;
            text-decoration: none;
        }

        .navbar-menu {
            display: flex;
            gap: 20px;
        }

        .navbar-menu a {
            color: #65676b;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 8px;
            transition: background-color 0.3s;
        }

        .navbar-menu a:hover {
            background-color: #f2f2f2;
        }
        .main-container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            max-width: 1200px;
            margin: 80px auto 0;
            padding: 20px;
        }

        .sidebar {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .profile-card {
            text-align: center;
            margin-bottom: 20px;
        }

        .profile-card img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin-bottom: 10px;
            object-fit: cover;
        }

        .weather-greeting {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .content {
            background: transparent;
        }
        .post-create {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .post-input {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            resize: none;
            margin-bottom: 15px;
            font-family: inherit;
        }

        .post-actions {
            display: flex;
            gap: 10px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }

        .post-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .photo-wall {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .photo-item {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .photo-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .photo-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .photo-info {
            padding: 12px;
        }

        .photo-actions {
            display: flex;
            gap: 15px;
            padding: 8px 12px;
            border-top: 1px solid #eee;
        }

        .photo-action {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #65676b;
            cursor: pointer;
            transition: color 0.2s;
        }

        .photo-action:hover {
            color: #ff4b6e;
        }
        .right-sidebar {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .memories-section {
            margin-bottom: 20px;
        }

        .memories-section h3 {
            margin-bottom: 15px;
            color: #1c1e21;
            font-size: 1.1em;
        }

        .memory-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .memory-item:hover {
            background-color: #f7f8f9;
        }

        .memory-item img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }

        .memory-info {
            flex: 1;
        }

        .memory-info h4 {
            font-size: 0.9em;
            margin-bottom: 4px;
        }

        .memory-info p {
            font-size: 0.8em;
            color: #65676b;
        }

        .post-item {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .post-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .post-header img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .post-meta {
            flex: 1;
        }

        .post-meta h3 {
            font-size: 1em;
            margin-bottom: 2px;
        }

        .post-meta time {
            font-size: 0.8em;
            color: #65676b;
        }

        .post-content {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .post-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .post-images img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .post-images img:hover {
            transform: scale(1.05);
        }

        .post-actions {
            display: flex;
            gap: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .post-action {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #65676b;
            cursor: pointer;
            transition: color 0.2s;
        }

        .post-action:hover {
            color: #ff4b6e;
        }
        .save-container {
    margin-top: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.save-btn {
    background: #ff9eaf;
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.save-btn:hover {
    background: #ff7c8e;
    transform: scale(1.05);
}

.save-status {
    color: #666;
    font-size: 0.9em;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 999;
    position: relative;
}

@keyframes fadeOut {
    0% { opacity: 1; }
    100% { opacity: 0; }
}

.diary-editor {
            width: 100%;
            min-height: 200px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
        }
        .add-photo-btn {
            background-color: #ff9eaf;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .add-photo-btn:hover {
            background-color: #ff8c9e;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="#" class="navbar-brand">üíë Êàë‰ª¨ÁöÑÊÅãÁà±Êó•ËÆ∞</a>
        <div class="navbar-menu">
            <a href="#"><i class="fas fa-home"></i> È¶ñÈ°µ</a>
            <a href="#"><i class="fas fa-images"></i> Áõ∏ÂÜå</a>
            <a href="#"><i class="fas fa-heart"></i> ÂõûÂøÜ</a>
        </div>
    </nav>
    
    <div class="main-container">
        <aside class="sidebar">
            <div class="profile-card">
                <img src="2.jpg" alt="ÊÉÖ‰æ£Â§¥ÂÉè">
                <h3>Êàë‰ª¨Âú®‰∏ÄËµ∑</h3>
                <p>Â∑≤Áªè 365 Â§©</p>
            </div>
            <div class="weather-greeting">
                <h4><i class="fas fa-cloud-sun"></i> ‰ªäÊó•Â§©Ê∞î</h4>
                <p id="weather">Ê≠£Âú®Ëé∑ÂèñÂ§©Ê∞î‰ø°ÊÅØ...</p>
                <p id="greeting"></p>
            </div>
        </aside>

        <main class="content">
            <div class="diary-posts">
                <!-- Âä®ÊÄÅÂÜÖÂÆπÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
            </div>
        <div class="weather-greeting">
            <h2>‰ªäÊó•Â§©Ê∞î & ÈóÆÂÄô</h2>
            <p id="weather">Ê≠£Âú®Ëé∑ÂèñÂ§©Ê∞î‰ø°ÊÅØ...</p>
            <p id="greeting"></p>
        </div>

            <div class="post-create">
                <textarea class="post-input" placeholder="ÂàÜ‰∫´Ê≠§ÂàªÁöÑÂøÉÊÉÖ..."></textarea>
                <div class="post-actions">
                    <button onclick="document.getElementById('photo-input').click()" style="background: #f0f2f5; color: #65676b;">
                        <i class="fas fa-images"></i> Ê∑ªÂä†ÁÖßÁâá
                    </button>
                    <button onclick="saveDiary()" style="background: #ff4b6e; color: white;">
                        <i class="fas fa-paper-plane"></i> ÂèëÂ∏É
                    </button>
                </div>
                <input type="file" id="photo-input" style="display: none" accept="image/*" multiple>
            </div>

            <div class="photo-wall" id="photo-wall">
                <!-- È¢ÑËÆæÁöÑÁÖßÁâá -->
                <div class="photo-item">
                    <img src="IMG_20221118_163239.jpg" alt="ÊÅãÁà±ÁÖßÁâá">
                    <div class="photo-info">
                        <p>2022-11-18</p>
                    </div>
                    <div class="photo-actions">
                        <span class="photo-action"><i class="fas fa-heart"></i> ÂñúÊ¨¢</span>
                        <span class="photo-action"><i class="fas fa-comment"></i> ËØÑËÆ∫</span>
                    </div>
                </div>
                <div class="photo-item">
                    <img src="IMG_20221120_175534.jpg" alt="ÊÅãÁà±ÁÖßÁâá">
                    <div class="photo-info">
                        <p>2022-11-20</p>
                    </div>
                    <div class="photo-actions">
                        <span class="photo-action"><i class="fas fa-heart"></i> ÂñúÊ¨¢</span>
                        <span class="photo-action"><i class="fas fa-comment"></i> ËØÑËÆ∫</span>
                    </div>
                </div>
                <div class="photo-item">
                    <img src="IMG_20221206_130927.jpg" alt="ÊÅãÁà±ÁÖßÁâá">
                    <div class="photo-info">
                        <p>2022-12-06</p>
                    </div>
                    <div class="photo-actions">
                        <span class="photo-action"><i class="fas fa-heart"></i> ÂñúÊ¨¢</span>
                        <span class="photo-action"><i class="fas fa-comment"></i> ËØÑËÆ∫</span>
                    </div>
                </div>
                <div class="photo-item">
                    <img src="IMG_20221207_162332.jpg" alt="ÊÅãÁà±ÁÖßÁâá">
                    <div class="photo-info">
                        <p>2022-12-07</p>
                    </div>
                    <div class="photo-actions">
                        <span class="photo-action"><i class="fas fa-heart"></i> ÂñúÊ¨¢</span>
                        <span class="photo-action"><i class="fas fa-comment"></i> ËØÑËÆ∫</span>
                    </div>
                </div>
            </div>

        </main>

        <aside class="right-sidebar">
            <div class="memories-section">
                <h3><i class="fas fa-history"></i> ÂæÄÊó•ÂõûÂøÜ</h3>
                <div class="memory-item">
                    <img src="IMG_20221118_163239.jpg" alt="ÂõûÂøÜÁÖßÁâá">
                    <div class="memory-info">
                        <h4>Á¨¨‰∏ÄÊ¨°Á∫¶‰ºö</h4>
                        <p>2022-11-18</p>
                    </div>
                </div>
                <div class="memory-item">
                    <img src="IMG_20221120_175534.jpg" alt="ÂõûÂøÜÁÖßÁâá">
                    <div class="memory-info">
                        <h4>ÁîúËúúÊôöÈ§ê</h4>
                        <p>2022-11-20</p>
                    </div>
                </div>
                <div class="memory-item">
                    <img src="IMG_20221206_130927.jpg" alt="ÂõûÂøÜÁÖßÁâá">
                    <div class="memory-info">
                        <h4>Âë®Êú´Êº´Ê≠•</h4>
                        <p>2022-12-06</p>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <script>
    // Â§©Ê∞î‰ª£Á†ÅËΩ¨Êç¢
    function getWeatherText(code) {
        const weatherMap = {
            'Sunny': '<i class="fas fa-sun"></i> Êô¥Â§©',
            'Clear': '<i class="fas fa-moon"></i> Êô¥Â§ú',
            'Cloudy': '<i class="fas fa-cloud"></i> Â§ö‰∫ë',
            'Overcast': '<i class="fas fa-cloud-meatball"></i> Èò¥Â§©',
            'Mist': '<i class="fas fa-smog"></i> ÈõæÂ§©',
            'Rain': '<i class="fas fa-cloud-rain"></i> ÈôçÈõ®',
            'Snow': '<i class="fas fa-snowflake"></i> ÈôçÈõ™'
        };
        return weatherMap[code] || 'Êú™Áü•Â§©Ê∞î ‚ùì';
    }

    // Êó∂Èó¥ÈóÆÂÄôËØ≠
    function getTimeGreeting() {
        const hour = new Date().getHours();
        if (hour < 6) return 'ÂáåÊô®Â•Ω üåô Ë¶ÅÊ≥®ÊÑè‰ºëÊÅØÂì¶ÔΩû';
        if (hour < 9) return 'Êó©‰∏äÂ•Ω üåÖ ‰ªäÂ§©‰πüË¶ÅÂÖÉÊ∞îÊª°Êª°ÔºÅ';
        if (hour < 12) return '‰∏äÂçàÂ•Ω üåû ÊÉ≥Êàë‰∫ÜÂêóÔºü';
        if (hour < 14) return '‰∏≠ÂçàÂ•Ω üçú ÂêÉÈ•±È•±ÊâçÊúâÂäõÊ∞îÊÉ≥ÊàëÔΩû';
        if (hour < 18) return '‰∏ãÂçàÂ•Ω ‚òï Â∑•‰ΩúÂ≠¶‰π†Ë¶ÅÂä†Ê≤πÂì¶ÔºÅ';
        if (hour < 22) return 'Êôö‰∏äÂ•Ω üåÜ ‰∏ÄËµ∑ÁúãÊòüÊòüÂêóÔºü';
        return 'Â§úÊ∑±Âï¶ üåô Êó©ÁÇπ‰ºëÊÅØÂà´ÁÜ¨Â§úÔΩû';
    }

    // Êõ¥Êñ∞Â§©Ê∞î‰ø°ÊÅØ
    function updateWeather() {
    // Ê∑ªÂä†Âä†ËΩΩÁä∂ÊÄÅÊèêÁ§∫
    const weatherGreeting = document.querySelector('.weather-greeting');
    weatherGreeting.innerHTML = '<i class="fas fa-spinner fa-pulse"></i> Ê≠£Âú®Ëé∑ÂèñÂ§©Ê∞î‰ø°ÊÅØ...';
        const response = await fetch(`https://api.weatherapi.com/v1/current.json?key=e4168a903aae497f94981118251803&q=${latitude},${longitude}&aqi=no`);
            if(!response.ok) throw new Error(`APIÂìçÂ∫îÈîôËØØ: ${response.status}`);
            const data = await response.json();
            break;
            .then(response => response.json())
            .then(data => {
                const weatherText = getWeatherText(data.current_weather.weathercode);
                const weatherInfo = `ÂÆûÊó∂Â§©Ê∞îÔºö${data.current.temp_c}¬∞C ${weatherText}
ÊπøÂ∫¶Ôºö${data.current.humidity}% | È£éÈÄüÔºö${data.current.wind_kph}km/h`;
                document.getElementById('weather').textContent = weatherInfo;
            })
            .catch(error => {
                console.error('Ëé∑ÂèñÂ§©Ê∞î‰ø°ÊÅØÂ§±Ë¥•:', error);
                document.getElementById('weather').textContent = 'Â§©Ê∞î‰ø°ÊÅØËé∑ÂèñÂ§±Ë¥•';
            });
    }

    // ÂàùÂßãÂåñÈ°µÈù¢
    document.addEventListener('DOMContentLoaded', function() {
        // Êõ¥Êñ∞Âú®‰∏ÄËµ∑ÁöÑÂ§©Êï∞
        const startDate = new Date('2022-11-18');
        const today = new Date();
        const days = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
        document.querySelector('.profile-card p').textContent = `Â∑≤Áªè ${days} Â§©`;

        // Êõ¥Êñ∞Â§©Ê∞îÂíåÈóÆÂÄôËØ≠
        updateWeather();
        updateGreeting();
        setInterval(updateWeather, 1800000); // ÊØè30ÂàÜÈíüÊõ¥Êñ∞‰∏ÄÊ¨°Â§©Ê∞î
        setInterval(updateGreeting, 3600000); // ÊØèÂ∞èÊó∂Êõ¥Êñ∞‰∏ÄÊ¨°ÈóÆÂÄôËØ≠

        // ÂàùÂßãÂåñÁÖßÁâá‰∏ä‰º†ÂäüËÉΩ
        initPhotoUpload();

        // ÂàùÂßãÂåñÂèëÂ∏ÉÂäüËÉΩ
        initPostFunction();

        // ÂàùÂßãÂåñÁÇπËµûÂäüËÉΩ
        initLikeFunction();

        // ÂàùÂßãÂåñÊó•ËÆ∞ÁºñËæëÂô®
        initDiaryEditor();
    });

    // ÂàùÂßãÂåñÁÖßÁâá‰∏ä‰º†ÂäüËÉΩ
    function initPhotoUpload() {
        const photoInput = document.getElementById('photo-input');
        if (!photoInput) return;

        photoInput.addEventListener('change', function(e) {
            const files = e.target.files;
            if (files.length === 0) return;

            const previewContainer = document.createElement('div');
            previewContainer.className = 'post-images';
            
            Array.from(files).forEach(file => {
                if (!file.type.startsWith('image/')) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = 'È¢ÑËßàÂõæÁâá';
                    previewContainer.appendChild(img);
                }
                reader.readAsDataURL(file);
            });

            const existingPreview = document.querySelector('.post-create .post-images');
            if (existingPreview) {
                existingPreview.remove();
            }
            document.querySelector('.post-create').insertBefore(previewContainer, document.querySelector('.post-actions'));
        });
    }

    // ÂàùÂßãÂåñÂèëÂ∏ÉÂäüËÉΩ
    function initPostFunction() {
        const postButton = document.querySelector('.post-actions button:last-child');
        if (!postButton) return;

        postButton.addEventListener('click', function() {
            const content = document.querySelector('.post-input').value;
            const images = Array.from(document.querySelectorAll('.post-create .post-images img')).map(img => img.src);
            
            if (content.trim() || images.length > 0) {
                createPost(content, images);
                document.querySelector('.post-input').value = '';
                const previewContainer = document.querySelector('.post-create .post-images');
                if (previewContainer) {
                    previewContainer.remove();
                }
            }
        });
    }

    // ÂàùÂßãÂåñÁÇπËµûÂäüËÉΩ
    function initLikeFunction() {
        document.addEventListener('click', function(e) {
            const action = e.target.closest('.photo-action');
            if (action && action.querySelector('.fas.fa-heart')) {
                action.innerHTML = '<i class="fas fa-heart" style="color: #ff4b6e;"></i> Â∑≤ÂñúÊ¨¢';
            }
        });
    }
    

    // Êõ¥Êñ∞ÈóÆÂÄôËØ≠
    function updateGreeting() {
        const greeting = getTimeGreeting();
        document.getElementById('greeting').textContent = greeting;
    }

    // ÂàùÂßãÂåñÊó•ËÆ∞ÁºñËæëÂô®
    function initDiaryEditor() {
        const editor = document.querySelector('.diary-editor');
        if (!editor) return;

        // Âä†ËΩΩÂ∑≤‰øùÂ≠òÁöÑÂÜÖÂÆπ
        const savedContent = localStorage.getItem('diaryContent');
        if (savedContent) {
            editor.value = savedContent;
        }

        // Ëá™Âä®‰øùÂ≠òÂäüËÉΩ
        let saveTimeout;
        editor.addEventListener('input', function() {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                localStorage.setItem('diaryContent', editor.value);
                showSaveStatus('Â∑≤Ëá™Âä®‰øùÂ≠ò');
            }, 1000);
        });
    }

    // ÊòæÁ§∫‰øùÂ≠òÁä∂ÊÄÅ
    function showSaveStatus(message) {
        const statusElement = document.querySelector('.save-status');
        if (!statusElement) return;

        statusElement.textContent = message;
        statusElement.style.opacity = '1';
        
        setTimeout(() => {
            statusElement.style.animation = 'fadeOut 1s forwards';
            setTimeout(() => {
                statusElement.style.opacity = '0';
                statusElement.style.animation = '';
            }, 1000);
        }, 2000);
    }

    // ÂàõÂª∫Êñ∞Âä®ÊÄÅ
    function createPost(content, images) {
        const post = document.createElement('div');
        post.className = 'post-item';
        
        post.innerHTML = `
            <div class="post-header">
                <img src="2.jpg" alt="Â§¥ÂÉè">
                <div class="post-meta">
                    <h3>Êàë‰ª¨ÁöÑÊïÖ‰∫ã</h3>
                    <time>${new Date().toLocaleString()}</time>
                </div>
            </div>
            <div class="post-content">${content.replace(/\n/g, '<br>')}</div>
            ${images.length > 0 ? `
                <div class="post-images">
                    ${images.map(src => `<img src="${src}" alt="Âä®ÊÄÅÂõæÁâá">`).join('')}
                </div>
            ` : ''}
            <div class="post-actions">
                <span class="post-action"><i class="fas fa-heart"></i> ÂñúÊ¨¢</span>
                <span class="post-action"><i class="fas fa-comment"></i> ËØÑËÆ∫</span>
                <span class="post-action"><i class="fas fa-share"></i> ÂàÜ‰∫´</span>
            </div>
        `;

        document.querySelector('.diary-posts').insertBefore(post, document.querySelector('.diary-posts').firstChild);
    }

    // Ëé∑ÂèñÂú∞ÁêÜ‰ΩçÁΩÆ
navigator.geolocation.getCurrentPosition(async position => {
    let retries = 3;
    while(retries--) {
        try {
    // ÊàêÂäüËé∑Âèñ‰ΩçÁΩÆÁöÑÂõûË∞É
    handlePosition(position.coords);
        } catch (error) {
            if(!retries) {
                console.error('Â§©Ê∞îËé∑ÂèñÂ§±Ë¥•:', error);
                document.querySelector('.weather-greeting').innerHTML = 
                    `‚ö†Ô∏è Â§©Ê∞îËé∑ÂèñÂ§±Ë¥•: ${error.message || 'ËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•'}`;
                // ‰ΩøÁî®ÈªòËÆ§Âåó‰∫¨ÂùêÊ†á‰Ωú‰∏∫ÂêéÂ§á
                latitude = 39.9042;
                longitude = 116.4074;
                break;
            }
            await new Promise(resolve => setTimeout(resolve, 2000));
        }
    }
    // Ëé∑Âèñ‰ΩçÁΩÆÂ§±Ë¥•Êó∂‰ΩøÁî®ÈªÑÂ≤õÈªòËÆ§ÂùêÊ†á
    console.log('‰ΩçÁΩÆËé∑ÂèñÂ§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§ÂùêÊ†á:', error);
    handlePosition({ latitude: 36.0667, longitude: 120.3826 });
});

function handlePosition({ latitude, longitude }) {
    
    // Ëé∑ÂèñÂ§©Ê∞îÊï∞ÊçÆ
    fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true`)
        .then(response => response.json())
        .then(data => {
            const weatherText = getWeatherText(data.current_weather.weathercode);
            const weatherInfo = `ÂÆûÊó∂Â§©Ê∞îÔºö${data.current.temp_c}¬∞C ${weatherText}
ÊπøÂ∫¶Ôºö${data.current.humidity}% | È£éÈÄüÔºö${data.current.wind_kph}km/h`;
            document.getElementById('weather').textContent = weatherInfo;
            // ÂàùÂßãÂåñÈóÆÂÄôËØ≠
updateGreeting();

// ÊØèÂ∞èÊó∂Êõ¥Êñ∞‰∏ÄÊ¨°ÈóÆÂÄôËØ≠
setInterval(updateGreeting, 3600000);

function updateGreeting() {
    document.getElementById('greeting').textContent = getTimeGreeting();
}
        });
});

// ‰øùÂ≠òÊó•ËÆ∞ÂäüËÉΩ
function saveDiary() {
    const editor = document.querySelector('.diary-editor');
    const diaryCard = document.createElement('div');
    diaryCard.className = 'diary-card';
    diaryCard.innerHTML = `
        <time>${new Date().toLocaleString()}</time>
        <div>${editor.value.replace(/\n/g, '<br>')}</div>
/g, '<br>')}</div>
    `;
    document.querySelector('.diary-posts').prepend(diaryCard);
    editor.value = '';
    showSaveStatus('‰øùÂ≠òÊàêÂäü', '#4CAF50');
}

function showSaveStatus(text, color) {
    const status = document.getElementById('saveStatus');
    status.textContent = text;
    status.style.color = color;
    status.style.opacity = '1';
    setTimeout(() => status.style.opacity = '0', 2000);
}

// Â§ÑÁêÜÁÖßÁâá‰∏ä‰º†
document.getElementById('photo-input').addEventListener('change', function(e) {
            const files = e.target.files;
            const photoWall = document.getElementById('photo-wall');
            
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoItem = document.createElement('div');
                    photoItem.className = 'photo-item';
                    photoItem.innerHTML = `<img src="${e.target.result}" alt="ÊÅãÁà±ÁÖßÁâá">`;
                    photoWall.appendChild(photoItem);
                }
                reader.readAsDataURL(file);
            }
        });



        // Êó•ËÆ∞‰øùÂ≠òÂäüËÉΩ
        const diaryEditor = document.querySelector('.diary-editor');
        const saveStatus = document.getElementById('saveStatus');
        
        // ÂàùÂßãÂåñÂÜÖÂÆπ
        diaryEditor.value = localStorage.getItem('loveDiary') || '';
        
        // Ëá™Âä®‰øùÂ≠ò
        diaryEditor.addEventListener('input', () => {
            try {
                localStorage.setItem('loveDiary', diaryEditor.value);
                diaryEditor.style.height = 'auto';
                diaryEditor.style.height = diaryEditor.scrollHeight + 'px';
            } catch (e) {
                if (e.name === 'QuotaExceededError') {
                    showSaveStatus('Â≠òÂÇ®Á©∫Èó¥Â∑≤Êª°ÔºåËØ∑Âà†Èô§ÈÉ®ÂàÜÂÜÖÂÆπ', 'error');
                }
            }
        });
        
        // ÊâãÂä®‰øùÂ≠ò
        function saveDiary() {
            try {
                localStorage.setItem('loveDiary', diaryEditor.value);
                showSaveStatus('‰øùÂ≠òÊàêÂäüÔºÅ', 'success');
            } catch (e) {
                showSaveStatus('‰øùÂ≠òÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');
            }
        }
        
        function showSaveStatus(text, type) {
            saveStatus.textContent = text;
            saveStatus.style.color = type === 'success' ? '#67c23a' : '#f56c6c';
            saveStatus.style.opacity = '1';
            setTimeout(() => {
                saveStatus.style.opacity = '0';
            }, 2000);
        }


    </script>
</body>
</html>
